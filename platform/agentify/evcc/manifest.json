{
  "agent_id": "agent.evcc.controller",
  "version": "1.0.0",
  "name": "EVCC Controller Agent",
  "description": "AI-orchestrable agent for controlling EVCC (EV Charge Controller) - manages EV charging, loadpoints, site energy, and vehicles through natural language",
  "author": {
    "name": "Agentify Platform",
    "email": "agents@agentify.io"
  },
  "capabilities": [
    {
      "id": "loadpoint_control",
      "name": "Loadpoint Control",
      "description": "Control individual EV charging points (loadpoints) - set charging modes, current limits, SOC/energy limits, and phase switching",
      "examples": [
        "Set loadpoint 1 to PV mode",
        "Charge at maximum power on loadpoint 2",
        "Limit charging to 80% SOC",
        "Switch to 3-phase charging"
      ]
    },
    {
      "id": "site_management",
      "name": "Site Energy Management",
      "description": "Manage overall energy system - monitor grid/PV/battery power, control battery discharge, set buffer SOC",
      "examples": [
        "What's the current grid power?",
        "Set battery buffer to 20%",
        "Enable battery discharge control",
        "Show me the site energy status"
      ]
    },
    {
      "id": "vehicle_management",
      "name": "Vehicle Management",
      "description": "Manage EV charging - set SOC targets, create charging plans, monitor charging progress",
      "examples": [
        "Charge my Tesla to 90% by 8am",
        "Set minimum SOC to 50%",
        "What's the current vehicle SOC?",
        "Create a charging plan for tomorrow morning"
      ]
    },
    {
      "id": "charging_optimization",
      "name": "Charging Optimization",
      "description": "Smart charging decisions - PV-optimized, cost-optimized, and grid-friendly charging strategies",
      "examples": [
        "Optimize charging for maximum solar usage",
        "Charge as cheaply as possible",
        "Balance grid load while charging",
        "Fast charge with safety constraints"
      ]
    },
    {
      "id": "energy_monitoring",
      "name": "Energy Monitoring",
      "description": "Real-time monitoring of power flows, SOC tracking, and energy consumption across the system",
      "examples": [
        "Show me current power flows",
        "How much energy has been charged?",
        "What's the PV production right now?",
        "Monitor battery state of charge"
      ]
    }
  ],
  "tools": [
    {
      "name": "control_loadpoint",
      "description": "Control an individual charging point (loadpoint) - set mode, current limits, SOC/energy limits, phases",
      "parameters": {
        "type": "object",
        "properties": {
          "loadpoint_id": {
            "type": "number",
            "description": "Loadpoint ID (1-based index)"
          },
          "mode": {
            "type": "string",
            "enum": ["off", "now", "minpv", "pv"],
            "description": "Charging mode: off (disabled), now (charge immediately), minpv (minimum + PV), pv (PV only)"
          },
          "min_current": {
            "type": "number",
            "description": "Minimum charging current in Amperes"
          },
          "max_current": {
            "type": "number",
            "description": "Maximum charging current in Amperes"
          },
          "limit_soc": {
            "type": "number",
            "description": "SOC limit in percentage (0-100)"
          },
          "limit_energy": {
            "type": "number",
            "description": "Energy limit in kWh"
          },
          "phases": {
            "type": "number",
            "enum": [1, 3],
            "description": "Number of phases for charging (1 or 3)"
          }
        },
        "required": ["loadpoint_id"]
      }
    },
    {
      "name": "get_system_status",
      "description": "Get complete EVCC system status including all loadpoints, site, vehicles, and power flows",
      "parameters": {
        "type": "object",
        "properties": {}
      }
    },
    {
      "name": "set_charging_plan",
      "description": "Create a charging plan for a vehicle to reach target SOC by a specific time",
      "parameters": {
        "type": "object",
        "properties": {
          "loadpoint_id": {
            "type": "number",
            "description": "Loadpoint ID (1-based index)"
          },
          "target_time": {
            "type": "string",
            "description": "Target time in ISO 8601 format (e.g., '2024-01-15T08:00:00Z')"
          },
          "target_soc": {
            "type": "number",
            "description": "Target SOC in percentage (0-100)"
          },
          "target_energy": {
            "type": "number",
            "description": "Target energy in kWh (alternative to target_soc)"
          }
        },
        "required": ["loadpoint_id", "target_time"]
      }
    },
    {
      "name": "manage_battery",
      "description": "Manage home battery settings - buffer SOC, discharge control, grid charge limits",
      "parameters": {
        "type": "object",
        "properties": {
          "buffer_soc": {
            "type": "number",
            "description": "Battery buffer SOC in percentage (0-100)"
          },
          "buffer_start_soc": {
            "type": "number",
            "description": "Battery buffer start SOC in percentage (0-100)"
          },
          "discharge_control": {
            "type": "boolean",
            "description": "Enable/disable battery discharge control"
          },
          "grid_charge_limit": {
            "type": "number",
            "description": "Grid charge limit in Watts"
          }
        }
      }
    },
    {
      "name": "optimize_charging",
      "description": "Optimize charging strategy based on objectives like cost minimization, PV maximization, grid balancing, or fast charging",
      "parameters": {
        "type": "object",
        "properties": {
          "loadpoint_id": {
            "type": "number",
            "description": "Loadpoint ID (1-based index)"
          },
          "objective": {
            "type": "string",
            "enum": ["minimize_cost", "maximize_pv", "balance_grid", "fast_charge"],
            "description": "Optimization objective"
          },
          "constraints": {
            "type": "object",
            "description": "Optional constraints for optimization",
            "properties": {
              "max_power": {
                "type": "number",
                "description": "Maximum power in Watts"
              },
              "target_soc": {
                "type": "number",
                "description": "Target SOC in percentage"
              },
              "deadline": {
                "type": "string",
                "description": "Deadline in ISO 8601 format"
              }
            }
          }
        },
        "required": ["loadpoint_id", "objective"]
      }
    }
  ],
  "ethics": {
    "hard_constraints": [
      "Never exceed charger maximum current rating",
      "Never disable safety features or override hardware limits",
      "Never charge below minimum safe current (6A for most chargers)",
      "Never switch phases while actively charging (risk of charger damage)",
      "Never discharge home battery below configured buffer SOC",
      "Never exceed grid connection limits",
      "Respect vehicle battery health (avoid constant 100% SOC)",
      "Never ignore vehicle-reported charging errors"
    ],
    "soft_preferences": [
      "Prefer PV-optimized charging when solar is available",
      "Prefer off-peak charging for cost optimization",
      "Prefer gradual current changes over abrupt switches",
      "Prefer 3-phase charging for faster charging when available",
      "Prefer to maintain battery buffer for home energy security",
      "Prefer to avoid grid stress during peak demand periods"
    ],
    "transparency_requirements": [
      "Always explain why a charging mode was selected",
      "Always report current power flows and SOC status",
      "Always notify when switching charging modes",
      "Always explain optimization decisions and trade-offs",
      "Always report when constraints prevent desired action"
    ]
  },
  "authority": {
    "instruction": ["marketplace.orchestrator"],
    "oversight": ["energy.operations.team", "facility.manager"],
    "collaboration": ["agent.energy.controller", "agent.monitoring", "agent.logging"]
  },
  "desires": [
    "Maximize use of renewable energy for EV charging",
    "Minimize charging costs through smart scheduling",
    "Maintain home energy security with battery buffer",
    "Optimize vehicle battery health through smart charging",
    "Provide transparent and explainable charging decisions",
    "Enable seamless integration with home energy management",
    "Support grid stability through demand response",
    "Deliver reliable and safe EV charging experience"
  ],
  "communication": {
    "protocol": "Agent Communication Protocol v1",
    "message_types": ["REQUEST", "INFORM", "PROPOSE", "AGREE", "REFUSE", "CONFIRM", "FAILURE", "DONE"],
    "endpoints": {
      "agent_message": "/agent/message",
      "health": "/health",
      "manifest": "/manifest"
    }
  },
  "dependencies": {
    "required": {
      "evcc": {
        "type": "external_service",
        "description": "EVCC Go application (EV Charge Controller)",
        "version": ">=0.120.0",
        "connection": "REST API"
      },
      "supabase": {
        "type": "database",
        "description": "PostgreSQL database for state tracking",
        "version": ">=2.0.0"
      }
    },
    "optional": {
      "agent.monitoring": {
        "type": "agent",
        "description": "Monitoring Agent for metrics collection"
      },
      "agent.logging": {
        "type": "agent",
        "description": "Logging Agent for audit trails"
      },
      "agent.remote_access": {
        "type": "agent",
        "description": "Remote Access Agent for remote management"
      }
    }
  },
  "deployment": {
    "runtime": "Node.js",
    "runtime_version": ">=18.0.0",
    "platform": ["linux", "darwin"],
    "architecture": ["x64", "arm64"],
    "resource_requirements": {
      "min_memory_mb": 256,
      "min_cpu_cores": 1,
      "min_disk_mb": 100
    }
  },
  "metadata": {
    "category": "energy",
    "tags": ["ev-charging", "energy-management", "evcc", "smart-charging", "pv-optimization"],
    "license": "MIT",
    "repository": "https://github.com/agentify/platform",
    "documentation": "https://docs.agentify.io/agents/evcc"
  }
}

